<!DOCTYPE html>
<html>
<head>
<title>文字列処理.html</title>
<style>
.textarea
{
    resize: none;
    height: 14vw;
    width: 20%;
}

input[type='text']
{
    border: 1px solid black;
}

.textarea, input[type='text']
{
    tab-size: 10;
    background-color: rgb(255, 255, 255);
}

.textarea:hover:focus, input[type='text']:hover:focus
{
    background-color: rgb(240, 255, 255);
}

.textarea:hover, input[type='text']:hover
{
    background-color: rgb(255, 255, 240);
}

.textarea:focus, input[type='text']:focus
{
    background-color: rgb(255, 240, 255);
}

.span
{
    margin: 0px 0px;
    padding: 0px 0px;
    font-size: 150px;
}

.span2
{
    margin: 0px 0px;
    padding: 0px 0px;
    font-size: 50px;
}

.p
{
    margin: -40px 0px;
}

.inline
{
    display: inline-block;
}
</style>
</head>

<body onload="onLoad()" oninput="setURL()">
<p class="span2">行リストの結合：</p>
<textarea class="textarea" id="Input1" oninput="Forever()" placeholder="1"></textarea>
<span class="span">+</span>
<textarea class="textarea" id="Input2" oninput="Forever()" placeholder="2"></textarea>
<span class="span">=</span>
<textarea class="textarea" id="Output" placeholder="3" readonly></textarea>
<button onclick="clipboard('Output')">copy</button>
<p class="p"></p>
<span>行数:</span>
<span id="Length1"></span>
<span>,</span>
<span id="Length2"></span>

<p></p>

<div>
    <span class="span2">インデント：</span>
    <div class="inline">
        <div>
            <span>インデントをカスタマイズ</span>
            <input type="text" id="Indent" oninput="Forever2()" placeholder="#n"></input>
            <button onclick="clipboard('Indent')">copy</button>
        </div>

        <div>
            <span>インデントのプレビュー</span>
            <input type="text" id="Result" oninput="Forever3()" placeholder="0"></input>
            <button onclick="clipboard('Result')">copy</button>
        </div>
    </div>
</div>

<div>
    <select id="Select" oninput="SELECT()">
        <option selected>インデントの説明...</option>
        <option>#t</option>
        <option>#s</option>
        <option>#S</option>
        <option>#d</option>
        <option>#D</option>
        <option>#n</option>
        <option>#N</option>
    </select>

    <span id="element"></span>
</div>

<textarea class="textarea" id="Input3" oninput="Forever2()" placeholder="4"></textarea>
<span class="span">⇒</span>
<textarea class="textarea" id="Output1" placeholder="5" readonly></textarea>

<button onclick="clipboard('Output1')">copy</button>
<p class="p"></p>

<span>行数:</span>
<span id="Length3"></span>

<script src="https://E24028.github.io/URL操作.js"></script>
<script>
var Input1 = document.getElementById('Input1');
var Input2 = document.getElementById('Input2');
var Input3 = document.getElementById('Input3');

var Length1 = document.getElementById('Length1');
var Length2 = document.getElementById('Length2');
var Length3 = document.getElementById('Length3');

var Output = document.getElementById('Output');
var Output1 = document.getElementById('Output1');

var Indent = document.getElementById('Indent');
var Result = document.getElementById('Result');
var Select = document.getElementById('Select');
var element = document.getElementById('element');

function onLoad()
{
    Input1.value = getParams('data1');
    Input2.value = getParams('data2');
    Input3.value = getParams('data3');
    Result.value = getParams('indent');
    Select.value = getParams('select') || 'インデントの説明...';

    Forever();
    Forever3();
    SELECT();

    setURL();
}

function Forever()
{
    var Text1 = Input1.value;
    // 改行コードで分割し、配列に格納
    var Lines1 = Text1.split(/\n/);
    var TextLength1 = Lines1.length;
    Length1.innerText = TextLength1;

    var Text2 = Input2.value;
    // 改行コードで分割し、配列に格納
    var Lines2 = Text2.split(/\n/);
    var TextLength2 = Lines2.length;
    Length2.innerText = TextLength2;

    Output.value = '';

    var Repeats = Math.max(TextLength1, TextLength2);
    for (let i = 0; i < Repeats; i++)
    {
        if (Lines1[i] == undefined)
        {
            var Line1 = '';
        } else {
            var Line1 = Lines1[i];
        }

        if (Lines2[i] == undefined)
        {
            var Line2 = '';
        } else {
            var Line2 = Lines2[i];
        }

        var Lines = Line1 + Line2;
        var String = Lines.toString();
        Output.value += String;

        if (i < Repeats - 1)
        {
            Output.value += '\n';
        }
    }
}

function Forever2()
{
    var Replaced = Indent.value
        .replace(/#t/g, '\t')
        .replace(/#s/g, ' ')
        .replace(/#S/g, '　')
        .replace(/#d/g, '.')
        .replace(/#D/g, '・');

    Result.value = Replaced
        .replace(/#n/g, '0')
        .replace(/#N/g, '０');

    var Text3 = Input3.value;

    // 改行コードで分割し、配列に格納
    var Lines3 = Text3.split(/\n/);

    var TextLength3 = Lines3.length;

    Length3.innerText = TextLength3;

    Output1.value = '';

    var Repeats = TextLength3;

    for (let i = 0; i < Repeats; i++)
    {
        var Value = Replaced
            .replace(/#n/g, (i + 1))
            .replace(/#N/g, ZENKAKU(i + 1));

        var Line3 = Lines3[i];

        var Lines = Value + Line3;
        var String = Lines.toString();
        Output1.value += String;

        if (i < Repeats - 1)
        {
            Output1.value += '\n';
        }
    }
}

function Forever3()
{
    Indent.value = Result.value
        .replace(/\t/g, '#t')
        .replace(/ /g, '#s')
        .replace(/　/g, '#S')
        .replace(/\./g, '#d')
        .replace(/・/g, '#D')
        .replace(/0/g, '#n')
        .replace(/０/g, '#N');

    Forever2();
}

function ZENKAKU(text)
{
    return text
        .toString()
        .replace(/0/g, '０')
        .replace(/1/g, '１')
        .replace(/2/g, '２')
        .replace(/3/g, '３')
        .replace(/4/g, '４')
        .replace(/5/g, '５')
        .replace(/6/g, '６')
        .replace(/7/g, '７')
        .replace(/8/g, '８')
        .replace(/9/g, '９');
}

function SELECT()
{
    var example = '選択してインデントの説明を見る...';

    if (Select.value == '#t')
    {
        example = 'タブ文字';
    }

    if (Select.value == '#s')
    {
        example = '半角スペース';
    }

    if (Select.value == '#S')
    {
        example = '全角スペース';
    }

    if (Select.value == '#d')
    {
        example = '. (半角ドット)';
    }

    if (Select.value == '#D')
    {
        example = '・ (全角ドット)';
    }

    if (Select.value == '#n')
    {
        example = '行番号 (半角数字)';
    }

    if (Select.value == '#N')
    {
        example = '行番号 (全角数字)';
    }

    element.innerText = example;
}

function setURL()
{
    setParams(
        ['data1', Input1.value],
        ['data2', Input2.value],
        ['data3', Input3.value],
        ['indent', Result.value],
        ['select', Select.value]
    );
}

function clipboard(id)
{
    const Element = document.getElementById(id);
    navigator.clipboard.writeText(Element.value);
    alert('copied! text: ' + Element.value);
}
</script>
</body>
</html>
